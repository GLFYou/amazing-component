<template>
  <div class="apple-web-container">
    <section class="s1">
      <div class="t1">
        iPad Pro
        <div class="t2" id="s1-video1-trigger">由 M2 强势驱动</div>
        <div class="M2img"><img src="@/assets/images/icons/m2_logo__90ungfqgnsiu_medium.png" alt="" /></div>
      </div>
      <div class="video1"><video ref="video1Ref" src="@/assets/videos/medium_2x.mp4" muted></video></div>
      <div class="t3">
        &emsp;&emsp;震撼性能、超先进显示屏、疾速无线网络连接、Apple Pencil 高维玩法、种种 iPadOS 16 强大新功能，终极 iPad 体验，在此合体。<br />
        <span class="btn1">观看影片 <i class="iconfont icon-bofang"></i></span>
      </div>
    </section>
    <section class="s2">
      <div class="t1">
        M2 芯片，<br />
        强大新生代
      </div>
      <div class="img1">
        <img src="@/assets/images/photos/performance_hero__cxya4f2p5euu_medium.jpg" alt="" />
        <div class="t2">Octance X</div>
      </div>
      <div class="t3">
        <span> M2 芯片。</span>
        M2 是新一代 Apple 芯片，它的 8 核中央处理器提速最高达 15%，10 核图形处理器提速最高达 35%1；神经网络引擎也提速 40%，让机器学习任务执行得更快；再配合增大 50% 的内存带宽，M2 为 iPad Pro
        注入澎湃性能和众多新功能。因此你可以尽情创作极具真实感的三维画面，构建复杂的增强现实模型，或是以高帧率畅玩主机级画质的游戏。同时仍能拥有出色的电池续航，可从早用到晚2。
      </div>
      <div class="img2"><img class="img2-2" id="s2-img2-trigger" src="@/assets/images/photos/m2_end_state__d1wjtfymwb8m_large.jpg" alt="" /><img class="img2-1" src="@/assets/images/photos/m2_start_state__bt83pgdysr1e_large.jpg" alt="" /></div>
      <div class="t4">
        <div class="t4-1">
          <div class="t4-n-1"><span>8</span><span>核</span></div>
          <div class="t4-n-2">中央处理器</div>
        </div>
        <div class="t4-2">
          <div class="t4-n-1"><span>10</span><span>核</span></div>
          <div class="t4-n-2">图形处理器</div>
        </div>
        <div class="t4-3">
          <div class="t4-n-1"><span>16</span><span>核</span></div>
          <div class="t4-n-2">神经网络引擎</div>
        </div>
      </div>
      <div class="img3">
        <img src="@/assets/images/photos/graphics_screen__cr7y07sbcoae_large.jpg" alt="" /><img src="@/assets/images/photos/graphics_hardware__b31jmd39gk2q_large.png" alt="" />
        <div class="t4">
          <div class="t4-1"><span>你手上的，是全套电影工作室。</span>M2 的高性能媒体处理引擎让 ProRes 编解码大大提速。因此你能以最快达之前 3 倍的速度，将视频项目转为 ProRes 格式3。</div>
          <div class="t4-2"><span>能拍 ProRes 视频。</span>得益于 M2 的高性能媒体处理引擎和图像信号处理器，再加上先进的摄像头，你现在可以用 iPad Pro 拍摄 ProRes 视频了。而且五个录音棚级麦克风搭配支持杜比全景声的四扬声器系统，无论是收音还是播放，声音品质都是影院级的。</div>
        </div>
        <div class="t5">DaVinci Resolve for iPad</div>
      </div>
    </section>
    <section class="s3">
      <div class="t1">
        12.9 英寸<br />
        Liquid 视网膜 XDR 屏，<br />
        亮出巅峰。
      </div>
      <div class="t2">
        <span>极致动态范围，看 12.9 英寸 iPad Pro 的4。</span>Liquid 视网膜 XDR 显示屏的对比度高达 1000000:1，能呈现出栩栩如生的画面细节，无论是欣赏、编辑 HDR 照片和视频，还是看电影、追剧，效果都非常震撼。它的亮度表现也非常抢眼：全屏亮度 1000 尼特，峰值亮度高达 1600 尼特。此外，像 P3
        广色域、原彩显示和 ProMotion 自适应刷新率这些先进的显示技术，也一样不少。而对色彩精准度要求更高的那类工作项目，它还备有参考模式。
      </div>
      <div class="scroll-pin-container" id="s3-img1-trigger">
        <div class="s3ImgBox1"><img class="s3-img1-1" src="@/assets/images/photos/xdr_hero__cdjowjx4v0eq_large.jpg" alt="" /></div>
        <!-- <div class="s3ImgBox2">
          <img class="s3-img2-1" src="@/assets/images/photos/xdr_leds__fnxiwkuv3oya_medium.jpg" alt="" />
        </div> -->
        <div class="t3">
          <div class="t3-n">
            <div class="t3-n-1"><span>1000尼特</span></div>
            <div class="t3-n-2">全屏亮度</div>
          </div>
          <div class="t3-n">
            <div class="t3-n-1"><span>1600尼特</span></div>
            <div class="t3-n-2">峰值亮度</div>
          </div>
          <div class="t3-n">
            <div class="t3-n-1"><span>原彩显示</span></div>
            <div class="t3-n-2">观感舒适</div>
          </div>
          <div class="t3-n">
            <div class="t3-n-1"><span>1000000:1</span></div>
            <div class="t3-n-2">对比度</div>
          </div>
          <div class="t3-n">
            <div class="t3-n-1"><span>ProMotion</span></div>
            <div class="t3-n-2">自适应120Hz刷新率</div>
          </div>
          <div class="t3-n">
            <div class="t3-n-1"><span>P3</span></div>
            <div class="t3-n-2">广色域</div>
          </div>
        </div>
        <div class="t4">
          <div class="tn-1">
            采用超过
            <p>10000 颗</p>
            mini‑LED
          </div>
          <div class="tn-2">
            <span>mini‑LED 加身。</span> 为了实现极高的亮度，我们在显示屏背面布满了 LED 背光阵列。考虑到要在 iPad Pro 如此纤薄的机身中嵌入这么多颗 LED，我们还选用了特别设计的 mini-LED，与过去相比足足小了 120 倍。此外，光学薄膜和扩散板也是定制的，不仅混合光线的效率更高，大小也妥帖适配仅有 6.4
            毫米的纤薄机身。
          </div>
        </div>
        <div class="t5">
          <div class="tn-1">
            超过
            <p>2500 个</p>
            局部调光区
          </div>
          <div class="tn-2">
            <span>局部调光区。</span> 这 10000 多颗 mini-LED 被划分为 2500 多个局部调光区。根据屏幕显示内容的不同，每个调光区都可以精确调节亮度，从而实现 1000000:1 的惊人对比度。即使是那些细节特别丰富，又带有耀眼高光的 HDR 内容，比如璀璨星河和动作大片的爆炸场面，画面效果也格外真实生动。
          </div>
        </div>
        <div class="t6">
          11 英寸<br />
          Liquid 视网膜屏，<br />
          随手带出一片绚丽。<br />
        </div>
        <div class="img2"><img src="@/assets/images/photos/liquid_retina_endframe__ba3q4hiulfxe_large.jpg" alt="" /></div>
        <div class="t7"><span>看着舒服，带着轻松。 </span>11 英寸 iPad Pro 的 Liquid 视网膜显示屏不仅绚丽夺目、轻巧便携，还拥有多项先进技术4，比如 ProMotion 自适应刷新率、原彩显示、P3 广色域和超低反射率，让屏幕用起来响应灵敏，看起来赏心悦目。</div>
        <div class="t8">
          <div class="t8-n">
            <div class="t8-n-1"><span>1600尼特</span></div>
            <div class="t8-n-2">峰值亮度</div>
          </div>
          <div class="t8-n">
            <div class="t8-n-1"><span>原彩显示</span></div>
            <div class="t8-n-2">观感舒适</div>
          </div>
          <div class="t8-n">
            <div class="t8-n-1"><span>ProMotion</span></div>
            <div class="t8-n-2">自适应 120Hz 刷新率</div>
          </div>
          <div class="t8-n">
            <div class="t8-n-1"><span>P3</span></div>
            <div class="t8-n-2">广色域</div>
          </div>
        </div>
      </div>
    </section>
  </div>
</template>
<script setup>
import { gsap } from 'gsap'
import { ScrollTrigger } from 'gsap/ScrollTrigger'
import { onBeforeUnmount } from 'vue'
gsap.registerPlugin(ScrollTrigger)

const video1Ref = ref(null)
const gsapFn = () => {
  // s1播放视频
  ScrollTrigger.create({
    trigger: '#s1-video1-trigger',
    start: 'top top',
    onEnter: () => {
      video1Ref.value.play()
    }
  })

  // s2芯片脱壳
  ScrollTrigger.create({
    trigger: '#s2-img2-trigger',
    start: 'top top',
    onEnter: () => {
      gsap.to('.img2-1', {
        opacity: 0,
        duration: 0.5,
        scale: 1.3,
        x: '-50%'
      })
    },
    onEnterBack: () => {
      gsap.to('.img2-1', {
        opacity: 1,
        duration: 0.5,
        scale: 1,
        x: '-50%'
      })
    }
  })

  // s3 ipad滚动固定
  let ipadImgHeight = 0
  ScrollTrigger.create({
    trigger: '#s3-img1-trigger',
    start: 'top top',
    pin: true,
    end: '+=2000',
    // snap: [0, 0.1, 0.5, 0.8, 1],
    onEnter: () => {
      ipadImgHeight = gsap.getProperty('.s3ImgBox1', 'height')
    },
    // onLeaveBack: () => {
    //   gsap.to('.s3-img1', {
    //     y: 0,
    //     duration: 0.5
    //   })
    // },
    onUpdate: ({ progress, direction, isActive }) => {
      progress = Number(progress.toFixed(3))
      console.log(progress)
      if (progress < 0.3) {
        gsap.to('.s3ImgBox1', {
          scale: 1 + 1 * ((1 / 0.3) * progress),
          y: -0.8 * ipadImgHeight * ((1 / 0.3) * progress)
        })
      }
      if (progress >= 0.3 && progress < 0.5) {
        gsap.to('.s3 .t3', {
          opacity: 1 * ((1 / 0.2) * (progress - 0.3)),
          y: `${100 - 100 * (1 / 0.2) * (progress - 0.3)}vh`
        })
      }
      if (progress >= 0.5 && progress < 0.7) {
        gsap.to('.s3 .t3', {
          opacity: 1 - 1 * ((1 / 0.1) * (progress - 0.5)),
          y: `${-100 * (1 / 0.2) * (progress - 0.5)}vh`
        })
        gsap.to('.s3 .t4', {
          opacity: 1 * ((1 / 0.2) * (progress - 0.5)),
          y: `${100 - 100 * (1 / 0.2) * (progress - 0.5)}vh`
        })
      }
      if (progress >= 0.7 && progress < 0.9) {
        gsap.to('.s3 .t4', {
          opacity: 1 - 1 * ((1 / 0.1) * (progress - 0.7)),
          y: `${-100 * (1 / 0.2) * (progress - 0.7)}vh`
        })
        gsap.to('.s3 .t5', {
          opacity: 1 * ((1 / 0.2) * (progress - 0.7)),
          y: `${100 - 100 * (1 / 0.2) * (progress - 0.7)}vh`
        })
      }
    }
  })
}

onMounted(() => {
  gsapFn()
})
onBeforeUnmount(() => {
  ScrollTrigger.killAll()
})
</script>

<style lang="scss" scoped>
.apple-web-container {
  width: 100vw;
  background-color: #000000;
  font-weight: bold;

  @mixin abs-position-center {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
  }
  @mixin light-dark-text {
    font-size: calc(8px + 1vw);
    line-height: 1.5em;
    color: rgba(255, 255, 255, 0.6);
    span {
      color: #fff;
    }
  }
  @mixin h1-text {
    width: max-content;
    font-size: calc(15px + 3vw);
    line-height: 1.2em;
  }
  @mixin h2-text {
    font-size: calc(15px + 1vw);
    line-height: 1.5em;
  }
  @mixin mini-text {
    font-size: calc(10px + 0.3vw);
  }

  .s1 {
    width: 100%;
    height: calc(80vh + 40vw);
    // border: 1px solid aqua;
    position: relative;

    .t1 {
      @include abs-position-center;
      @include h1-text;
      top: 5vh;
      z-index: 1;
    }
    .t2 {
      @include abs-position-center;
      top: calc(2vh + 2vw);
      padding: 10px;
      width: max-content;
      color: transparent;
      font-size: calc(20px + 1vw);
      background: -webkit-linear-gradient(0deg, #be22ff 20%, #ff279c 50%, #ff981f 80%);
      -webkit-background-clip: text;
      background-clip: text;
      z-index: 1;
    }
    .M2img {
      @include abs-position-center;
      top: calc(6vh + 5vw);
      width: fit-content;
      z-index: 1;
    }
    .video1 {
      @include abs-position-center;
      top: calc(40vh - 20vw);
      z-index: 0;
      width: 70%;
      video {
        width: 100%;
      }
    }
    .t3 {
      @include abs-position-center;
      @include h2-text;
      bottom: 5vh;
      width: 70%;
      text-align: center;
      .btn1 {
        text-align: center;
        width: fit-content;
        color: #2997ff;
        font-size: calc(10px + 1vw);
        i {
          font-size: calc(15px + 1vw);
          vertical-align: middle;
        }
      }
    }
  }
  .s2 {
    width: 100%;
    height: calc(200vh + 140vw);
    // border: 1px solid rgb(102, 255, 0);
    position: relative;

    .t1 {
      @include abs-position-center;
      @include h1-text;
      top: calc(5vh + 5vw);
    }
    .img1 {
      @include abs-position-center;
      top: calc(15vh + 15vw);
      width: 70%;
      img {
        width: 100%;
      }
      .t2 {
        font-size: 12px;
        font-weight: normal;
        color: rgba(255, 255, 255, 0.5);
      }
    }
    .t3 {
      @include abs-position-center;
      @include light-dark-text;
      top: calc(20vh + 75vw);
      width: 60%;
      z-index: 1;
    }
    .img2 {
      z-index: 0;
      @include abs-position-center;
      top: calc(45vh + 70vw);
      width: 100%;
      .img2-1 {
        @include abs-position-center;
        width: 80%;
        top: 0;
      }
      .img2-2 {
        @include abs-position-center;
        width: 80%;
        top: 0;
      }
    }
    .t4 {
      z-index: 1;
      @include abs-position-center;
      top: calc(50vh + 140vw);
      display: flex;
      flex-flow: row nowrap;
      width: 100%;
      justify-content: center;
      .t4-1,
      .t4-2,
      .t4-3 {
        margin: 0 4vw;
        .t4-n-1 {
          padding-top: 1.5vw;
          // height: calc(30px + 3vw);
          background-image: -webkit-linear-gradient(45deg, #ff981f, #ff279c);
          -webkit-background-clip: text;
          background-clip: text;
          color: transparent;
          span:nth-child(1) {
            vertical-align: baseline;
            // font-size: calc(30px + 3vw);
            @include h1-text;
          }
          span:nth-child(2) {
            @include h2-text;
            margin-left: 5px;
            vertical-align: baseline;
          }
        }
        .t4-n-2 {
          @include mini-text;
          color: #fff;
          font-weight: normal;
        }
      }
      .t4-2 {
        .t4-n-1 {
          background-image: -webkit-linear-gradient(45deg, #d83012, #ff22aa);
        }
      }
      .t4-3 {
        .t4-n-1 {
          background-image: -webkit-linear-gradient(90deg, #be22ff, #ae0aa1);
        }
      }
    }
    .img3 {
      z-index: 1;
      width: 100%;
      height: 100vh;
      @include abs-position-center;
      top: calc(90vh + 130vw);
      transform: translateX(0);
      img:nth-child(1) {
        height: 100%;
        z-index: 0;
        transform: scale(0.925);
        position: absolute;
        left: 0;
      }
      img:nth-child(2) {
        height: 100%;
        z-index: 1;
        position: absolute;
      }
      .t4 {
        height: 100%;
        position: absolute;
        top: 50%;
        left: -45%;
        transform: translateY(-50%);
        display: flex;
        flex-flow: column nowrap;
        .t4-1,
        .t4-2 {
          @include light-dark-text;
          margin-top: 5vh;
          width: 30%;
        }
      }
      .t5 {
        position: absolute;
        left: 5vw;
        bottom: -5vh;
        z-index: 2;
        font-size: 12px;
        font-weight: normal;
        color: rgba(255, 255, 255, 0.5);
      }
    }
  }
  .s3 {
    position: relative;
    width: 100%;
    height: calc(510vh + 60vw);
    // border: 1px solid red;
    .t1 {
      @include h1-text;
      position: absolute;
      left: 5%;
    }
    .t2 {
      @include light-dark-text;
      position: absolute;
      left: 5%;
      top: calc(15vh + 15vw);
      width: 70%;
    }
    .scroll-pin-container {
      @include abs-position-center;
      // border: 1px solid pink;
      top: calc(45vh + 20vw);
      width: 100%;
      height: fit-content;
      .s3ImgBox1 {
        @include abs-position-center;
        width: 80%;
        // z-index: 1;
        .s3-img1-1 {
          // position: absolute;
          // top: 0;
          width: 100%;
          // opacity: 0;
        }
      }
      // .s3ImgBox2 {
      //   @include abs-position-center;
      //   width: 100%;
      //   .s3-img2-1 {
      //     z-index: 1;
      //     position: absolute;
      //     top: 0;
      //     left: 0;
      //     width: 100%;
      //     opacity: 0.5;
      //   }
      // }
      .t3,
      .t4,
      .t5 {
        position: absolute;
        left: 5%;
        top: calc(15vh + 10vw);
        opacity: 0;
        transform: translateY(100vh);
      }
      .t3 {
        display: flex;
        flex-flow: row wrap;
        justify-content: space-between;
        width: 60%;
        .t3-n {
          width: 40%;
          .t3-n-1 {
            @include h1-text;
            background-image: -webkit-linear-gradient(45deg, #ff981f, #ff279c);
            color: transparent;
            -webkit-background-clip: text;
            background-clip: text;
          }
          .t3-n-2 {
            @include mini-text;
          }
        }
      }
      .t4,
      .t5 {
        width: 50%;
        .tn-1 {
          @include mini-text;
          p {
            @include h1-text;
            background-image: -webkit-linear-gradient(45deg, #ff981f, #ff279c);
            color: transparent;
            -webkit-background-clip: text;
            background-clip: text;
          }
        }
        .tn-2 {
          margin-top: 5vh;
          @include light-dark-text;
        }
      }
      .t6 {
        @include h1-text;
        position: absolute;
        left: 5%;
        top: 100vh;
      }
      .img2 {
        @include abs-position-center;
        top: calc(115vh + 10vw);
        width: 80%;
        img {
          width: 100%;
        }
      }
      .t7 {
        @include light-dark-text;
        position: absolute;
        right: 5%;
        width: 50%;
        top: calc(140vh + 30vw);
      }
      .t8 {
        position: absolute;
        left: 5%;
        top: calc(140vh + 30vw);
        .t8-n {
          .t8-n-1 {
            @include h1-text;
            background-image: -webkit-linear-gradient(45deg, #ffd85f, #14e8ad, #037aff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
          }
          .t8-n-2 {
            @include mini-text;
          }
        }
      }
    }
  }
}
</style>
